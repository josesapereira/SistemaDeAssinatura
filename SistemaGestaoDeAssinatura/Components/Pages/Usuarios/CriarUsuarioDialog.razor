@using Domain.DTOs
@using Radzen.Blazor
@attribute [Authorize]

@* <RadzenDialog>
    <EditForm Model="@model" OnValidSubmit="@OnSubmit">
        
    </EditForm>
</RadzenDialog> *@
<RadzenStack Orientation="Orientation.Horizontal" Gap="1rem">
    <RadzenStack class="w-75" Gap="1rem">
        <RadzenStack Orientation="Orientation.Horizontal">
            <RadzenFormField Text="RE" class="w-100">
                <RadzenTextBox @bind-Value="@model.UserName"
                               Placeholder="Digite o RE"
                               ReadOnly="@(modoEdicao)" />
            </RadzenFormField>
            <RadzenButton Style="width:100px" Click="OnREChanged" Text="Pesquisar" />
        </RadzenStack>


        <RadzenFormField Text="Nome" class="w-100">
            <RadzenTextBox @bind-Value="@model.Nome" ReadOnly="true" />
        </RadzenFormField>

        <RadzenFormField Text="Email" class="w-100">
            <RadzenTextBox @bind-Value="@model.Email" Placeholder="email@exemplo.com" />
        </RadzenFormField>

        <RadzenFormField Text="Role" class="w-100">
            <RadzenDropDown @bind-Value="@model.RoleIdString"
                            Data="@roles"
                            TextProperty="Name"
                            ValueProperty="IdString"
                            Placeholder="Selecione uma Role" />
        </RadzenFormField>
        <RadzenStack style="width:100px">
            <RadzenText Text="Ativo" />
            <RadzenSwitch @bind-Value="@model.Ativo" />
        </RadzenStack>

        <RadzenStack>
            <RadzenUpload Accept=".jpg,.jpeg,.png"
                          ChooseText="Upload Foto" InputAttributes="@(new Dictionary<string, object>() { { "aria-label", "select file" } })"
                          class="upload-aux"
                          Change="UploadRepitidas" Auto="true" Multiple="false" Icon="drive_folder_upload"
                          Style="margin-top:20px;" />

        </RadzenStack>
        <RadzenStack Orientation="Orientation.Horizontal" Gap="0.5rem" JustifyContent="JustifyContent.End" class="mt-3">
            <RadzenButton Text="Salvar" Click="OnSubmit" Icon="save" />
            <RadzenButton Text="Cancelar" ButtonStyle="ButtonStyle.Light" Click="@Cancelar" />
        </RadzenStack>
    </RadzenStack>
    
    <RadzenStack class="w-25">
        @if (model.ArquivoUpload != null && model.ArquivoUpload.Length > 0)
        {
            <RadzenText TextStyle="TextStyle.Caption" class="mt-1">
                @* Arquivo atual: @arquivoAtual *@
                <RadzenImage Style="max-width:200px; max-height:200px;"
                             Path="@($"data:image/png;base64,{Convert.ToBase64String(model.ArquivoUpload)}")" />
            </RadzenText>
        }
    </RadzenStack>

</RadzenStack>
