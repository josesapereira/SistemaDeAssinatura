@page "/usuarios"
@using Domain.DTOs
@using Radzen.Blazor
@attribute [Authorize]

<PageTitle>Usuários</PageTitle>

<RadzenStack Gap="1rem">
    <RadzenRow>
        <RadzenColumn>
            <RadzenText TextStyle="TextStyle.H3" Text="Gerenciamento de Usuários" />
        </RadzenColumn>
    </RadzenRow>

    <RadzenRow>
        <RadzenColumn>
            <RadzenStack Orientation="Orientation.Horizontal" Gap="0.5rem" JustifyContent="JustifyContent.End">
                <RadzenButton Text="Criar Novo" Icon="add" Click="@AbrirDialogCriar" />
            </RadzenStack>
        </RadzenColumn>
    </RadzenRow>

    <RadzenRow>
        <RadzenColumn>
            <RadzenDataGrid @ref="grid" LoadData="@LoadData" TItem="UsuarioListagemDTO" Data=@usuarios AllowPaging="true" PageSize="10" 
                           AllowSorting="true" FilterMode="FilterMode.Advanced" class="w-100">
                <Columns>
                    <RadzenDataGridColumn TItem="UsuarioListagemDTO" Property="RE" Title="RE" Width="120px" />
                    <RadzenDataGridColumn TItem="UsuarioListagemDTO" Property="Nome" Title="Nome" Width="250px" />
                    <RadzenDataGridColumn TItem="UsuarioListagemDTO" Property="Email" Title="Email" Width="250px" />
                    <RadzenDataGridColumn TItem="UsuarioListagemDTO" Property="Ativo" Title="Ativo" Width="100px">
                        <Template>
                            <RadzenBadge BadgeStyle="@(context.Ativo ? BadgeStyle.Success : BadgeStyle.Danger)" 
                                        Text="@(context.Ativo ? "Ativo" : "Inativo")" />
                        </Template>
                    </RadzenDataGridColumn>
                    <RadzenDataGridColumn TItem="UsuarioListagemDTO" Title="Ações" Width="150px" Sortable="false" Filterable="false">
                        <Template>
                            <RadzenStack Orientation="Orientation.Horizontal" Gap="0.5rem">
                                <RadzenButton Icon="edit" Size="ButtonSize.Small" 
                                            Click="@(() => AbrirDialogEditar(context))" 
                                            ButtonStyle="ButtonStyle.Info" />
                                <RadzenButton Icon="lock_reset" Size="ButtonSize.Small" 
                                            Click="@(() => ResetarSenha(context.RE))" 
                                            ButtonStyle="ButtonStyle.Warning" 
                                            Title="Resetar Senha" />
                                <RadzenButton Icon="security" Size="ButtonSize.Small" 
                                            Click="@(() => Resetar2FA(context.RE))" 
                                            ButtonStyle="ButtonStyle.Secondary" 
                                            Title="Resetar 2FA" />
                            </RadzenStack>
                        </Template>
                    </RadzenDataGridColumn>
                </Columns>
            </RadzenDataGrid>
        </RadzenColumn>
    </RadzenRow>
</RadzenStack>


